<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Configuration | Citrus Simulator Reference Guide</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.6.7">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="gitbook/style.css">
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-anchors/plugin.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-code_tomorrow_scheme/code-tomorrow-scheme.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-highlight/website.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-search/search.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-fontsettings/website.css">
        
    
    
        <link rel="stylesheet" href="./styles/website.css">
    

        
    
    
    <link rel="next" href="./user-interface.html" />
    
    
    <link rel="prev" href="./endpoint-component-support.html" />
    

        
    </head>
    <body>
        
        
    <div class="book"
        data-level="7.1"
        data-chapter-title="Configuration"
        data-filepath="endpoint-component-config.md"
        data-basepath="."
        data-revision="Mon Oct 24 2016 15:03:32 GMT+0200 (CEST)"
        data-innerlanguage="">
    

<div class="book-summary">
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="./index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="preconditions.html">
            
                
                    <a href="./preconditions.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        Preconditions
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2" data-path="installation.html">
            
                
                    <a href="./installation.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Installation
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3" data-path="concepts.html">
            
                
                    <a href="./concepts.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        Concepts
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="mapping-key-extractor.html">
            
                
                    <a href="./mapping-key-extractor.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        Mapping key extractor
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="scenarios.html">
            
                
                    <a href="./scenarios.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                        Simulator scenarios
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="intermediate-messages.html">
            
            <span><b>3.3.</b> Intermediate message handling</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4" data-path="rest-support.html">
            
                
                    <a href="./rest-support.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        REST support
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1" data-path="rest-config.html">
            
                
                    <a href="./rest-config.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                        Configuration
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="rest-request-mapping.html">
            
                
                    <a href="./rest-request-mapping.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.</b>
                        
                        Request mapping
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5" data-path="ws-support.html">
            
                
                    <a href="./ws-support.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        Web Service support
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1" data-path="ws-config.html">
            
                
                    <a href="./ws-config.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.</b>
                        
                        Configuration
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="ws-soap-faults.html">
            
                
                    <a href="./ws-soap-faults.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.2.</b>
                        
                        SOAP faults
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6" data-path="jms-support.html">
            
                
                    <a href="./jms-support.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                        JMS support
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.1" data-path="jms-config.html">
            
                
                    <a href="./jms-config.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.1.</b>
                        
                        Configuration
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7" data-path="endpoint-component-support.html">
            
                
                    <a href="./endpoint-component-support.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.</b>
                        
                        Endpoint component support
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="7.1" data-path="endpoint-component-config.html">
            
                
                    <a href="./endpoint-component-config.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.1.</b>
                        
                        Configuration
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="8" data-path="starter.html">
            
            <span><b>8.</b> Starter</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="8.1" data-path="starter-parameter.html">
            
            <span><b>8.1.</b> Parameters</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9" data-path="user-interface.html">
            
                
                    <a href="./user-interface.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.</b>
                        
                        Admin UI
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.1" data-path="status.html">
            
            <span><b>9.1.</b> Scenario status</span>
            
            
        </li>
    
        <li class="chapter " data-level="9.2" data-path="run.html">
            
            <span><b>9.2.</b> Run starters</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="10" data-path="samples.html">
            
            <span><b>10.</b> Samples</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="10.1" data-path="sample-rest.html">
            
            <span><b>10.1.</b> simulator-sample-rest</span>
            
            
        </li>
    
        <li class="chapter " data-level="10.2" data-path="sample-ws.html">
            
            <span><b>10.2.</b> simulator-sample-ws</span>
            
            
        </li>
    
        <li class="chapter " data-level="10.3" data-path="sample-jms.html">
            
            <span><b>10.3.</b> simulator-sample-jms</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="11" data-path="links.html">
            
                
                    <a href="./links.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>11.</b>
                        
                        Further Reading
                    </a>
            
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="./" >Citrus Simulator Reference Guide</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h2 id="endpoint-component-configuration"><a name="endpoint-component-configuration" class="plugin-anchor" href="#endpoint-component-configuration"><span class="fa fa-link"></span></a>Endpoint component configuration</h2>
<p>When using generic Citrus endpoints as simulator inbound source we need to configure those endpoint components. The most comfortable way is to
add a <strong>SimulatorEndpointComponentAdapter</strong> implementation to the classpath. The adapter provides several configuration methods.</p>
<pre><code class="lang-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SimulatorEndpointComponentAdapter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">SimulatorEndpointComponentConfigurer</span> </span>{


    <span class="hljs-annotation">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> Endpoint <span class="hljs-title">endpoint</span><span class="hljs-params">(ApplicationContext applicationContext)</span></span>;

    <span class="hljs-annotation">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">useSoapEnvelope</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;
    }

    <span class="hljs-annotation">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> MappingKeyExtractor <span class="hljs-title">mappingKeyExtractor</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> XPathPayloadMappingKeyExtractor();
    }
}
</code></pre>
<p>The adapter defines methods that configure the endpoint component used as inbound source. As usual we can set the mapping key extractor implementation or
add automatic SOAP envelope support.</p>
<p>More importantly we need to define an inbound endpoint that is used as source for scenarios. Let&apos;s have a simple endpoint component adapter example.</p>
<pre><code class="lang-java"><span class="hljs-keyword">import</span> com.consol.citrus.simulator.annotation.EnableEndpointComponent;
<span class="hljs-keyword">import</span> com.consol.citrus.simulator.annotation.SimulatorEndpointComponentAdapter;
<span class="hljs-keyword">import</span> com.consol.citrus.simulator.annotation.SimulatorApplication;
<span class="hljs-keyword">import</span> org.springframework.boot.SpringApplication;
<span class="hljs-keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;

<span class="hljs-annotation">@SpringBootApplication</span>
<span class="hljs-annotation">@SimulatorApplication</span>
<span class="hljs-annotation">@EnableEndpointComponent</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Simulator</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">SimulatorEndpointComponentAdapter</span> </span>{

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>{
        SpringApplication.run(Simulator.class, args);
    }

    <span class="hljs-annotation">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> Endpoint <span class="hljs-title">endpoint</span><span class="hljs-params">(ApplicationContext applicationContext)</span> </span>{
        MailServer mailServer = <span class="hljs-keyword">new</span> MailServer();
        mailServer.setPort(<span class="hljs-number">2222</span>);
        mailServer.setAutoStart(<span class="hljs-keyword">true</span>);

        <span class="hljs-keyword">return</span> mailServer;
    }

    <span class="hljs-annotation">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> MappingKeyExtractor <span class="hljs-title">mappingKeyExtractor</span><span class="hljs-params">()</span> </span>{
        XPathPayloadMappingKeyExtractor mappingKeyExtractor = <span class="hljs-keyword">new</span> XPathPayloadMappingKeyExtractor();
        NamespaceContextBuilder namespaceContextBuilder = <span class="hljs-keyword">new</span> NamespaceContextBuilder();
        namespaceContextBuilder.getNamespaceMappings().put(<span class="hljs-string">&quot;mail&quot;</span>, <span class="hljs-string">&quot;http://www.citrusframework.org/schema/mail/message&quot;</span>);
        mappingKeyExtractor.setNamespaceContextBuilder(namespaceContextBuilder);
        mappingKeyExtractor.setXpathExpression(<span class="hljs-string">&quot;/mail:mail-message/mail:subject&quot;</span>);
        <span class="hljs-keyword">return</span> mappingKeyExtractor;
    }
}
</code></pre>
<p>The custom adapter defines a Citrus mail server endpoint that should be used as inbound source. Any mail message that arrives at this mail server component will
trigger a new simulator scenario then. Also we overwrite the mapping key extractor implementation so that the mail subject evaluates to the scenario that should be executed.</p>
<p>This configuration would lead us to a mail server that responds to incoming mail messages base on the mail subject. So we can have several simulator
scenarios for different mail messages.</p>
<pre><code class="lang-java"><span class="hljs-annotation">@Scenario</span>(<span class="hljs-string">&quot;Hello&quot;</span>)
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HelloScenario</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">SimulatorEndpointScenario</span> </span>{

    <span class="hljs-annotation">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">configure</span><span class="hljs-params">()</span> </span>{
        scenario()
            .receive()
            .payload(<span class="hljs-string">&quot;&lt;mail-message xmlns=\&quot;http://www.citrusframework.org/schema/mail/message\&quot;&gt;&quot;</span> +
                        <span class="hljs-string">&quot;&lt;from&gt;user@citrusframework.org&lt;/from&gt;&quot;</span> +
                        <span class="hljs-string">&quot;&lt;to&gt;citrus@citrusframework.org&lt;/to&gt;&quot;</span> +
                        <span class="hljs-string">&quot;&lt;cc&gt;&lt;/cc&gt;&quot;</span> +
                        <span class="hljs-string">&quot;&lt;bcc&gt;&lt;/bcc&gt;&quot;</span> +
                        <span class="hljs-string">&quot;&lt;subject&gt;Hello&lt;/subject&gt;&quot;</span> +
                        <span class="hljs-string">&quot;&lt;body&gt;&quot;</span> +
                            <span class="hljs-string">&quot;&lt;contentType&gt;text/plain; charset=utf-8&lt;/contentType&gt;&quot;</span> +
                            <span class="hljs-string">&quot;&lt;content&gt;Say Hello!&lt;/content&gt;&quot;</span> +
                        <span class="hljs-string">&quot;&lt;/body&gt;&quot;</span> +
                    <span class="hljs-string">&quot;&lt;/mail-message&gt;&quot;</span>);

        scenario()
            .send()
            .payload(<span class="hljs-string">&quot;&lt;mail-response xmlns=\&quot;http://www.citrusframework.org/schema/mail/message\&quot;&gt;&quot;</span> +
                        <span class="hljs-string">&quot;&lt;code&gt;250&lt;/code&gt;&quot;</span> +
                        <span class="hljs-string">&quot;&lt;message&gt;OK&lt;/message&gt;&quot;</span> +
                    <span class="hljs-string">&quot;&lt;/mail-response&gt;&quot;</span>);
    }
}
</code></pre>
<p>The scenario implementation above uses the base class <strong>SimulatorEndpointScenario</strong> and listens for mail messages of subject <strong>Hello</strong>. The
mail XML marshalling is automatically done by Citrus. This is the usual way how the Citrus mail component handles mail messages and responses. That means we can use the default Citrus
features in our simulator, too. The scenario sends back a positive mail response to the calling client.</p>
<p>This is how we can use any Citrus endpoint component as simulator inbound source. This gives us the opportunity to support a huge set of message transports and
message types in our simulator applications. Each incoming request on the endpoint component triggers a new simulator scenario.</p>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="./endpoint-component-support.html" class="navigation navigation-prev " aria-label="Previous page: Endpoint component support"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="./user-interface.html" class="navigation navigation-next " aria-label="Next page: Admin UI"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="gitbook/app.js"></script>

    
    <script src="gitbook/plugins/gitbook-plugin-edit-link/plugin.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-code_tomorrow_scheme/code-tomorrow-scheme.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-code_tomorrow_scheme/plugin.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-search/lunr.min.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-search/search.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-sharing/buttons.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-fontsettings/buttons.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"edit-link":{"base":"https://github.com/christophd/citrus-simulator/edit/master/simulator-docs/src/manual","label":"Improve This Page"},"anchors":{},"code_tomorrow_scheme":{},"highlight":{},"search":{"maxIndexSize":1000000},"sharing":{"all":["facebook","google","twitter","weibo","instapaper"],"facebook":true,"google":false,"instapaper":false,"twitter":true,"vk":false,"weibo":false},"fontsettings":{"family":"sans","size":2,"theme":"white"}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
