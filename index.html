<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.3">
<meta name="author" content="Christoph Deppisch, Martin Maher, Georgi Todorov">
<title>Citrus Simulator</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
body{-webkit-font-smoothing:antialiased}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
body{tab-size:4}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css">
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{color:rgba(0,0,0,.4)}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top;line-height:1.45}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
<style>

    h1, h2, h3, h4, h5, h6, #toctitle {
        color: #3b73af;
    }

    div#toctitle {
        content: url("images/citrus-logo-tiny.png");
    }

</style>
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Citrus Simulator</h1>
<div class="details">
<span id="author" class="author">Christoph Deppisch</span><br>
<span id="author2" class="author">Martin Maher</span><br>
<span id="author3" class="author">Georgi Todorov</span><br>
<span id="revnumber">version 0.10.0-SNAPSHOT,</span>
<span id="revdate">2017-07-06</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">citrus-simulator</div>
<ul class="sectlevel1">
<li><a href="#introduction">1. Introduction</a>
<ul class="sectlevel2">
<li><a href="#limitations">1.1. Limitations</a>
<ul class="sectlevel3">
<li><a href="#java-8">1.1.1. Java 8</a></li>
<li><a href="#build-tools">1.1.2. Build tools</a></li>
<li><a href="#browsers">1.1.3. Browsers</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#installation">2. Installation</a>
<ul class="sectlevel2">
<li><a href="#download">2.1. Download</a></li>
<li><a href="#maven-archetype">2.2. Maven archetype</a>
<ul class="sectlevel3">
<li><a href="#build-sources">2.2.1. Build sources</a></li>
<li><a href="#simulator-artifacts">2.2.2. Simulator artifacts</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#concepts">3. Concepts</a>
<ul class="sectlevel2">
<li><a href="#simulator-application">3.1. Simulator application</a></li>
<li><a href="#properties">3.2. Properties</a></li>
<li><a href="#spring-bean-configuration">3.3. Spring bean configuration</a></li>
</ul>
</li>
<li><a href="#rest-support">4. REST support</a>
<ul class="sectlevel2">
<li><a href="#rest-config">4.1. Configuration</a></li>
<li><a href="#advanced-customizations">4.2. Advanced customizations</a></li>
<li><a href="#rest-request-mapping">4.3. Request mapping</a></li>
</ul>
</li>
<li><a href="#ws-support">5. Web Service support</a>
<ul class="sectlevel2">
<li><a href="#ws-config">5.1. Configuration</a></li>
<li><a href="#advanced-customizations-2">5.2. Advanced customizations</a></li>
<li><a href="#ws-soap-faults">5.3. SOAP faults</a></li>
</ul>
</li>
<li><a href="#jms-support">6. JMS support</a>
<ul class="sectlevel2">
<li><a href="#jms-config">6.1. Configuration</a></li>
</ul>
</li>
<li><a href="#endpoint-support">7. Endpoint support</a>
<ul class="sectlevel2">
<li><a href="#endpoint-config">7.1. Configuration</a></li>
</ul>
</li>
<li><a href="#user-interface">8. User interface</a>
<ul class="sectlevel2">
<li><a href="#user-interface-status">8.1. Status</a></li>
<li><a href="#user-interface-run">8.2. Run scenarios</a></li>
</ul>
</li>
<li><a href="#links">9. Links &amp; Further reading</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p><strong>Copyright © 2017 ConSol Software GmbH</strong><br>
<strong>Version: 0.10.0-SNAPSHOT</strong></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/citrus-logo-small.png" alt="citrus-logo"></span></p>
</div>
<!-- toc disabled -->
</div>
</div>
<div class="sect1">
<h2 id="introduction"><a class="anchor" href="#introduction"></a>1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This is a standalone simulator application for different message transports such as Http REST APIs, SOAP WebService interface and
JMS messaging.</p>
</div>
<div class="paragraph">
<p>Clients are able to access the simulator endpoints and the simulator answers with predefined response
messages. The simulator response logic is very powerful and enables us to simulate any kind of server interface.</p>
</div>
<div class="paragraph">
<p>The simulator uses the test framework Citrus <a href="https://www.citrusframework.org">https://www.citrusframework.org</a></p>
</div>
<div class="paragraph">
<p>Contributions and feedback is highly appreciated!</p>
</div>
<div class="sect2">
<h3 id="limitations"><a class="anchor" href="#limitations"></a>1.1. Limitations</h3>
<div class="paragraph">
<p><strong>NOTE:</strong> <em>This project is considered stable but still under construction!</em></p>
</div>
<div class="paragraph">
<p>The administration UI is stable not yet finished. Some features are still under construction. Some aspects are simply not covered yet.</p>
</div>
<div class="paragraph">
<p>Following from that we have to deal with some limitations and trade offs until the project emerges (hopefully with the help of the community, keeping our fingers crossed!).
However the administration UI is usable and most features are considered to be stable.</p>
</div>
<div class="paragraph">
<p>Please consider following limitations that we have right now:</p>
</div>
<div class="sect3">
<h4 id="java-8"><a class="anchor" href="#java-8"></a>1.1.1. Java 8</h4>
<div class="paragraph">
<p>The simulator is a Java application coded in Java 8. Following from that you need at least Java 8 to run it as a Spring Boot web application.
Please make sure that you have Java development kit installed and set up. You can verify this with this command in a new terminal window.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">java -version</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="build-tools"><a class="anchor" href="#build-tools"></a>1.1.2. Build tools</h4>
<div class="paragraph">
<p>The simulator uses Maven as build tool. If you only want to run a distribution artifact of the simulator you are fine with just Java on your machine. In case
you want to build and maintain your simulator instance you need Maven to build your simulator application. We used Maven 3 when coding the simulator. You can verify
the Maven installation on your host with this command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">mvn -version</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="browsers"><a class="anchor" href="#browsers"></a>1.1.3. Browsers</h4>
<div class="paragraph">
<p>The simulator provides a small web user interface when started. You can access this web UI with your browser. As we are in an early state in this project we do not
invest much time in full cross-browser compatibility. We use Chrome and Firefox during development. So the simulator application is most likely to be 100% working
on these two browsers. Of course other browsers might work without any limitations, too.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="installation"><a class="anchor" href="#installation"></a>2. Installation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Citrus simulator is a web application that uses Spring boot and Angular2. The simulator is able to run as Java application on your local machine
or as container/pod in Docker, Kubernetes or Openshift.</p>
</div>
<div class="sect2">
<h3 id="download"><a class="anchor" href="#download"></a>2.1. Download</h3>
<div class="paragraph">
<p>You can download an executable web archive representing the the latest simulator distribution located at
<a href="https://labs.consol.de/maven/repository/com/consol/citrus/citrus-simulator-web">labs.consol.de/maven/repository</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">curl -o citrus-simulator.war https://labs.consol.de/maven/repository/com/consol/citrus/citrus-simulator-web/1.0.1-SNAPSHOT/citrus-simulator-web-1.0.1-SNAPSHOT-executable.war</code></pre>
</div>
</div>
<div class="paragraph">
<p>Save the Java web archive to a folder on your local machine and start the Spring boot web application. The downloaded artifact should be executable
from command line like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">java -jar citrus-simulator.war</code></pre>
</div>
</div>
<div class="paragraph">
<p>You will see the application starting up. Usually you will see some console log output. The web server should start within seconds. Once the application is up and running
you can open your browser and point to <a href="http://localhost:8080">http://localhost:8080</a>.</p>
</div>
<div class="paragraph">
<p>That&#8217;s it you are ready to use the Citrus simulator now. Next thing would be to understand the <a href="#concepts">concepts</a> and create some <a href="#scenarios">simulator scenarios</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="maven-archetype"><a class="anchor" href="#maven-archetype"></a>2.2. Maven archetype</h3>
<div class="paragraph">
<p>The easiest way to get started with a new simulator project is to use a Maven archetype that creates a new project for you.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">mvn archetype:generate -DarchetypeGroupId=com.consol.citrus.archetypes -DarchetypeArtifactId=citrus-simulator-archetypes-rest</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you execute the command above the Maven archetype generator will ask you some questions about versions and project names. Once you have completed the generation
you get a new Maven project that is ready to use. The project is created in a new folder on your machine. Switch to that folder and continue to build the project.</p>
</div>
<div class="paragraph">
<p>There are different simulator archetypes available. Please pick the most convenient archetype according to your project purpose.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>citrus-simulator-archetypes-rest</strong> Http REST simulator sample</p>
</li>
<li>
<p><strong>citrus-simulator-archetypes-ws</strong> SOAP web service simulator sample</p>
</li>
<li>
<p><strong>citrus-simulator-archetypes-jms</strong> JMS simulator sample</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="build-sources"><a class="anchor" href="#build-sources"></a>2.2.1. Build sources</h4>
<div class="paragraph">
<p>You can directly build the new simulator project with</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">mvn install</code></pre>
</div>
</div>
<div class="paragraph">
<p>This compiles, tests and packages the new simulator project on your local machine. Now we can run the simulator:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">mvn spring-boot:run</code></pre>
</div>
</div>
<div class="paragraph">
<p>You will see the application starting up. Usually you will see some console log output. The web server should start within seconds. Once the application is up and running
you can open your browser and point to <a href="http://localhost:8080">http://localhost:8080</a>.</p>
</div>
<div class="paragraph">
<p>Now everything is set up and you can start to create some simulator scenarios.</p>
</div>
</div>
<div class="sect3">
<h4 id="simulator-artifacts"><a class="anchor" href="#simulator-artifacts"></a>2.2.2. Simulator artifacts</h4>
<div class="paragraph">
<p>The simulator project creates a web application artifact. After building you can find this WAR file in target/citrus-simulator-1.0.war</p>
</div>
<div class="paragraph">
<p>Name and version of that archive file may be different according to your project settings. You can start the simulator with Java</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">java -jar citrus-simulator-1.0.war</code></pre>
</div>
</div>
<div class="paragraph">
<p>You will see the application starting up. Usually you will see some console log output. The web server should start within seconds.
Once the application is up and running you can open your browser and point to <a href="http://localhost:8080">http://localhost:8080</a>.</p>
</div>
<div class="paragraph">
<p>That&#8217;s it you are ready to use the Citrus simulator.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="concepts"><a class="anchor" href="#concepts"></a>3. Concepts</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Citrus simulator project has the primary focus to provide messaging simulation as a standalone server. Once started the simulator
provides different endpoints (Http REST, JMS, SOAP Web Service, and so on) and waits for incoming requests. The time a request arrives at one of the endpoints
the simulator maps the request to a predefined <a href="#scenarios">simulator scenario</a> which is automatically executed immediately.</p>
</div>
<div class="paragraph">
<p>The mapping is done by <a href="#mapping-key-extractor">extracting a mapping key</a> from the request data. This can be a special request header or a XPath
expression that is evaluated on the request payload.</p>
</div>
<div class="paragraph">
<p>The <a href="#scenarios">simulator scenario</a> is capable of handling the request message and will return a proper response message to the calling client.
With different scenarios defined the simulator is able to respond to different requests accordingly.</p>
</div>
<div class="paragraph">
<p>Each scenario defines a very special simulation logic by using Citrus test actions that perform once the scenario is triggered by incoming requests.</p>
</div>
<div class="paragraph">
<p>This way each incoming request is processed and a proper response message is provided to the client. You can define default and fallback scenarios for
each simulator.</p>
</div>
<div class="paragraph">
<p>In addition to that the simulator provides a <a href="#user-interface">user interface</a> where executed scenarios state success or failure.
Also you can trigger scenarios manually.</p>
</div>
<div class="sect2">
<h3 id="simulator-application"><a class="anchor" href="#simulator-application"></a>3.1. Simulator application</h3>
<div class="paragraph">
<p>The simulator is based on Spring boot. This means we have a main class that loads the Spring boot application.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">com.consol.citrus.simulator.annotation.EnableRest</span>;
<span class="keyword">import</span> <span class="include">com.consol.citrus.simulator.annotation.SimulatorApplication</span>;
<span class="keyword">import</span> <span class="include">org.springframework.boot.SpringApplication</span>;
<span class="keyword">import</span> <span class="include">org.springframework.boot.autoconfigure.SpringBootApplication</span>;

<span class="annotation">@SpringBootApplication</span>
<span class="annotation">@SimulatorApplication</span>
<span class="annotation">@EnableRest</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Simulator</span> {
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        SpringApplication.run(Simulator.class, args);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This class is the main entrance for all configuration and customization statements. First of all the class is annotated as <strong>@SpringBootApplication</strong>
and <strong>@SimulatorApplication</strong>. This enables auto configuration for the simulator application. In addition to that we enable different aspects of the simulator
by using further annotations provided. In the sample above we use the <strong>@EnableRest</strong> annotation for Http REST endpoint support.</p>
</div>
<div class="paragraph">
<p>There are multiple annotations available for different transport endpoints:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>@EnableRest</strong> Enables <a href="#rest-support">Http REST support</a></p>
</li>
<li>
<p><strong>@EnableWs</strong> Enables <a href="#ws-support">SOAP web services support</a></p>
</li>
<li>
<p><strong>@EnableJms</strong> Enables <a href="#jms-support">JMS support</a></p>
</li>
<li>
<p><strong>@EnableEndpointComponent</strong> Enables generic <a href="#endpoint-component-support">endpoint component support</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="properties"><a class="anchor" href="#properties"></a>3.2. Properties</h3>
<div class="paragraph">
<p>The simulator is capable of loading configuration from system properties and property files. There are several properties that you can use in order to customize the simulator behavior. These
properties are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>citrus.simulator.configuration.class</strong> Java configuration class that is automatically loaded. (default is com.consol.citrus.simulator.SimulatorConfig)</p>
</li>
<li>
<p><strong>citrus.simulator.template.path</strong> Default path to message payload template files.</p>
</li>
<li>
<p><strong>citrus.simulator.default.scenario</strong> Default scenario name.</p>
</li>
<li>
<p><strong>citrus.simulator.timeout</strong> Timeout when waiting for inbound messages.</p>
</li>
<li>
<p><strong>citrus.simulator.template.validation</strong> Enable/disable schema validation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can set these properties as system properties or you can add a property file in following location:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>META-INF/citrus-simulator.properties</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The simulator will automatically load these properties during startup.</p>
</div>
</div>
<div class="sect2">
<h3 id="spring-bean-configuration"><a class="anchor" href="#spring-bean-configuration"></a>3.3. Spring bean configuration</h3>
<div class="paragraph">
<p>Citrus works with the Spring framework and the simulator is a Spring boot application. Therefore the configuration is done by adding and overwriting Spring beans in
the application context. The simulator automatically loads Spring beans defined in following locations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>META-INF/citrus-simulator.xml</strong> Xml Spring bean configuration file.</p>
</li>
<li>
<p><strong>com.consol.citrus.simulator.SimulatorConfig</strong> Java configuration class. You can customize this class by defining the property <strong>citrus.simulator.configuration.class</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All beans defined in there get automatically loaded to the simulator Spring application context.</p>
</div>
<div class="paragraph">
<p>Unresolved directive in manual/concepts.adoc - include::manual/mapping-key-extractor.adoc[]
Unresolved directive in manual/concepts.adoc - include::manual/scenarios.adoc[]
Unresolved directive in manual/concepts.adoc - include::manual/intermediate-messages.adoc[]</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="rest-support"><a class="anchor" href="#rest-support"></a>4. REST support</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The simulator is able to handle REST API calls such as Http GET, POST, PUT, DELETE and so on. The simulator defines a special
REST enabling annotation that we can use on the application class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">com.consol.citrus.simulator.annotation.EnableRest</span>;
<span class="keyword">import</span> <span class="include">com.consol.citrus.simulator.annotation.SimulatorApplication</span>;
<span class="keyword">import</span> <span class="include">org.springframework.boot.SpringApplication</span>;
<span class="keyword">import</span> <span class="include">org.springframework.boot.autoconfigure.SpringBootApplication</span>;

<span class="annotation">@SpringBootApplication</span>
<span class="annotation">@SimulatorApplication</span>
<span class="annotation">@EnableRest</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Simulator</span> {
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        SpringApplication.run(Simulator.class, args);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <strong>@EnableRest</strong> annotation performs some auto configuration steps and loads required beans for the Spring application context
in the Spring boot application.</p>
</div>
<div class="paragraph">
<p>After that we are ready to handle incoming REST API calls on the simulator. The simulator REST support provides a base REST scenario class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Scenario</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">Hello</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@RequestMapping</span>(value = <span class="string"><span class="delimiter">&quot;</span><span class="content">/services/rest/simulator/hello</span><span class="delimiter">&quot;</span></span>, method = RequestMethod.POST)
<span class="directive">public</span> <span class="type">class</span> <span class="class">HelloScenario</span> <span class="directive">extends</span> SimulatorRestScenario {

    <span class="annotation">@Override</span>
    <span class="directive">protected</span> <span class="type">void</span> configure() {
        scenario()
            .receive()
            .payload(<span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;Hello xmlns=</span><span class="char">\&quot;</span><span class="content">http://citrusframework.org/schemas/hello</span><span class="char">\&quot;</span><span class="content">&gt;</span><span class="delimiter">&quot;</span></span> +
                        <span class="string"><span class="delimiter">&quot;</span><span class="content">Say Hello!</span><span class="delimiter">&quot;</span></span> +
                     <span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;/Hello&gt;</span><span class="delimiter">&quot;</span></span>);

        scenario()
            .send()
            .payload(<span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;HelloResponse xmlns=</span><span class="char">\&quot;</span><span class="content">http://citrusframework.org/schemas/hello</span><span class="char">\&quot;</span><span class="content">&gt;</span><span class="delimiter">&quot;</span></span> +
                        <span class="string"><span class="delimiter">&quot;</span><span class="content">Hi there!</span><span class="delimiter">&quot;</span></span> +
                     <span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;/HelloResponse&gt;</span><span class="delimiter">&quot;</span></span>);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now the base REST scenario provides the basic receive and send operations for the scenario. Also note that we can use <strong>@RequestMapping</strong> annotations
for advanced <a href="#rest-request-mapping">REST request mapping</a>.</p>
</div>
<div class="paragraph">
<p>Besides that you can have several REST related configuration options as described in the following sections.</p>
</div>
<div class="sect2">
<h3 id="rest-config"><a class="anchor" href="#rest-config"></a>4.1. Configuration</h3>
<div class="paragraph">
<p>Once the REST support is enabled on the simulator we have different configuration options. The most comfortable way is to
add a <strong>SimulatorRestAdapter</strong> implementation to the classpath. The adapter provides several configuration methods.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">abstract</span> <span class="type">class</span> <span class="class">SimulatorRestAdapter</span> <span class="directive">implements</span> SimulatorRestConfigurer {

    <span class="annotation">@Override</span>
    <span class="directive">public</span> MappingKeyExtractor mappingKeyExtractor() {
        <span class="keyword">return</span> <span class="keyword">new</span> AnnotationRequestMappingKeyExtractor();
    }

    <span class="annotation">@Override</span>
    <span class="directive">public</span> HandlerInterceptor<span class="type">[]</span> interceptors() {
        <span class="keyword">return</span> <span class="keyword">new</span> HandlerInterceptor<span class="type">[]</span> { <span class="keyword">new</span> LoggingHandlerInterceptor() };
    }

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> urlMapping() {
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">/services/rest/**</span><span class="delimiter">&quot;</span></span>;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The adapter defines methods that configure the simulator REST handling. For instance we can add another mapping key extractor implementation or
add handler interceptors to the REST API call handling.</p>
</div>
<div class="paragraph">
<p><strong>Note</strong>
The REST support is using a different default mapping key extractor. The <strong>AnnotationRequestMappingKeyExtractor</strong> is active by default and enables <strong>@RequestMapping</strong>
related mapping on scenario classes. Read more about that in <a href="#rest-request-mapping">rest-request-mapping</a>.</p>
</div>
<div class="paragraph">
<p>The <strong>urlMapping</strong> defines how clients can access the simulator REST API. Assuming the Spring boot simulator application is running on port 8080 the
REST API would be accessible on this URI:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>http://localhhost:8080/services/rest/*</code></pre>
</div>
</div>
<div class="paragraph">
<p>The clients can send GET, POST, DELETE and other calls to that endpoint URI then. The simulator will respond with respective responses based on the called
scenario.</p>
</div>
<div class="paragraph">
<p>You can simply extend the adapter in a custom class for adding customizations.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Component</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MySimulatorRestAdapter</span> <span class="directive">extends</span> SimulatorRestAdapter {

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> urlMapping() {
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">/my-rest-service/**</span><span class="delimiter">&quot;</span></span>;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see the class is annotated with <strong>@Component</strong> annotation. This is because the adapter should be recognized by Spring in order to overwrite the default
REST adapter behavior. The custom adapter just overwrites the <strong>urlMapping</strong> method so the REST simulator API will be accessible for clients under this endpoint URI:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>http://localhhost:8080/my-rest-service/*</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is the simplest way to customize the simulator REST support. We can also use the adapter extension directly on the Spring boot main application class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">com.consol.citrus.simulator.annotation.EnableRest</span>;
<span class="keyword">import</span> <span class="include">com.consol.citrus.simulator.annotation.SimulatorRestAdapter</span>;
<span class="keyword">import</span> <span class="include">com.consol.citrus.simulator.annotation.SimulatorApplication</span>;
<span class="keyword">import</span> <span class="include">org.springframework.boot.SpringApplication</span>;
<span class="keyword">import</span> <span class="include">org.springframework.boot.autoconfigure.SpringBootApplication</span>;

<span class="annotation">@SpringBootApplication</span>
<span class="annotation">@SimulatorApplication</span>
<span class="annotation">@EnableRest</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Simulator</span> <span class="directive">extends</span> SimulatorRestAdapter {

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> urlMapping() {
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">/my-rest-service/**</span><span class="delimiter">&quot;</span></span>;
    }

    <span class="annotation">@Override</span>
    <span class="directive">public</span> MappingKeyExtractor mappingKeyExtractor() {
        HeaderMappingKeyExtractor mappingKeyExtractor = <span class="keyword">new</span> HeaderMappingKeyExtractor();
        mappingKeyExtractor.setHeaderName(<span class="string"><span class="delimiter">&quot;</span><span class="content">X-simulator-scenario</span><span class="delimiter">&quot;</span></span>);
        <span class="keyword">return</span> mappingKeyExtractor;
    }

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        SpringApplication.run(Simulator.class, args);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>So we have <strong>@EnableRest</strong> and REST adapter customizations combined on one single class.</p>
</div>
</div>
<div class="sect2">
<h3 id="advanced-customizations"><a class="anchor" href="#advanced-customizations"></a>4.2. Advanced customizations</h3>
<div class="paragraph">
<p>For a more advanced configuration option we can extend the <strong>SimulatorRestSupport</strong> implementation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">com.consol.citrus.simulator.annotation.EnableRest</span>;
<span class="keyword">import</span> <span class="include">com.consol.citrus.simulator.annotation.SimulatorRestSupport</span>;
<span class="keyword">import</span> <span class="include">com.consol.citrus.simulator.annotation.SimulatorApplication</span>;
<span class="keyword">import</span> <span class="include">org.springframework.boot.SpringApplication</span>;
<span class="keyword">import</span> <span class="include">org.springframework.boot.autoconfigure.SpringBootApplication</span>;

<span class="annotation">@SpringBootApplication</span>
<span class="annotation">@SimulatorApplication</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Simulator</span> <span class="directive">extends</span> SimulatorRestSupport {

    <span class="annotation">@Override</span>
    <span class="directive">protected</span> <span class="predefined-type">String</span> getUrlMapping() {
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">/my-rest-service/**</span><span class="delimiter">&quot;</span></span>;
    }

    <span class="annotation">@Override</span>
    <span class="directive">public</span> FilterRegistrationBean requestCachingFilter() {
        FilterRegistrationBean filterRegistrationBean = <span class="keyword">new</span> FilterRegistrationBean(<span class="keyword">new</span> RequestCachingServletFilter());

        <span class="predefined-type">String</span> urlMapping = getUrlMapping();
        <span class="keyword">if</span> (urlMapping.endsWith(<span class="string"><span class="delimiter">&quot;</span><span class="content">**</span><span class="delimiter">&quot;</span></span>)) {
            urlMapping = urlMapping.substring(<span class="integer">0</span>, urlMapping.length() - <span class="integer">1</span>);
        }
        filterRegistrationBean.setUrlPatterns(<span class="predefined-type">Collections</span>.singleton(urlMapping));
        <span class="keyword">return</span> filterRegistrationBean;
    }

    <span class="annotation">@Override</span>
    <span class="directive">public</span> HandlerMapping handlerMapping(ApplicationContext applicationContext) {
        SimpleUrlHandlerMapping handlerMapping = <span class="keyword">new</span> SimpleUrlHandlerMapping();
        handlerMapping.setOrder(Ordered.HIGHEST_PRECEDENCE);
        handlerMapping.setAlwaysUseFullPath(<span class="predefined-constant">true</span>);

        <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">Object</span>&gt; mappings = <span class="keyword">new</span> <span class="predefined-type">HashMap</span>&lt;&gt;();
        mappings.put(getUrlMapping(), getRestController(applicationContext));

        handlerMapping.setUrlMap(mappings);
        handlerMapping.setInterceptors(interceptors());

        <span class="keyword">return</span> handlerMapping;
    }

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        SpringApplication.run(Simulator.class, args);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>With that configuration option we can overwrite REST support auto configuration features on the simulator such as the <strong>requestCachingFilter</strong> or the <strong>handlerMapping</strong>.
We can not use the <strong>@EnableRest</strong> auto configuration annotation then. Instead we extend the <strong>SimulatorRestSupport</strong> implementation directly.</p>
</div>
</div>
<div class="sect2">
<h3 id="rest-request-mapping"><a class="anchor" href="#rest-request-mapping"></a>4.3. Request mapping</h3>
<div class="paragraph">
<p>Usually we define simulator scenarios and map them to incoming requests by their names. When using REST support on the simulator we can also
use request mapping annotations on scenarios in order to map incoming requests.</p>
</div>
<div class="paragraph">
<p>This looks like follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Scenario</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">Hello</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@RequestMapping</span>(value = <span class="string"><span class="delimiter">&quot;</span><span class="content">/services/rest/simulator/hello</span><span class="delimiter">&quot;</span></span>, method = RequestMethod.POST)
<span class="directive">public</span> <span class="type">class</span> <span class="class">HelloScenario</span> <span class="directive">extends</span> SimulatorRestScenario {

    <span class="annotation">@Override</span>
    <span class="directive">protected</span> <span class="type">void</span> configure() {
        scenario()
            .receive()
            .payload(<span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;Hello xmlns=</span><span class="char">\&quot;</span><span class="content">http://citrusframework.org/schemas/hello</span><span class="char">\&quot;</span><span class="content">&gt;</span><span class="delimiter">&quot;</span></span> +
                        <span class="string"><span class="delimiter">&quot;</span><span class="content">Say Hello!</span><span class="delimiter">&quot;</span></span> +
                     <span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;/Hello&gt;</span><span class="delimiter">&quot;</span></span>);

        scenario()
            .send()
            .payload(<span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;HelloResponse xmlns=</span><span class="char">\&quot;</span><span class="content">http://citrusframework.org/schemas/hello</span><span class="char">\&quot;</span><span class="content">&gt;</span><span class="delimiter">&quot;</span></span> +
                        <span class="string"><span class="delimiter">&quot;</span><span class="content">Hi there!</span><span class="delimiter">&quot;</span></span> +
                     <span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;/HelloResponse&gt;</span><span class="delimiter">&quot;</span></span>);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see the example above uses <strong>@RequestMapping</strong> annotation in addition to the <strong>@Scenario</strong> annotation. All requests on the request path
<strong>/services/rest/simulator/hello</strong> of method <strong>POST</strong> will be mapped to the scenario. With this strategy the simulator is able to map requests based
on methods, request paths and parameters.</p>
</div>
<div class="paragraph">
<p>The mapping strategy requires a special mapping key extractor implementation that automatically scans for scenarios with <strong>@RequestMapping</strong> annotations.
The <strong>AnnotationRequestMappingKeyExtractor</strong> is active by default so in case you need to apply different mapping strategies you must overwrite the mapping key extractor
in configuration adapter.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ws-support"><a class="anchor" href="#ws-support"></a>5. Web Service support</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The simulator is able to handle SOAP Web Service calls as a server. The simulator defines a special
SOAP enabling annotation that we can use on the application class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">com.consol.citrus.simulator.annotation.EnableWebService</span>;
<span class="keyword">import</span> <span class="include">com.consol.citrus.simulator.annotation.SimulatorApplication</span>;
<span class="keyword">import</span> <span class="include">org.springframework.boot.SpringApplication</span>;
<span class="keyword">import</span> <span class="include">org.springframework.boot.autoconfigure.SpringBootApplication</span>;

<span class="annotation">@SpringBootApplication</span>
<span class="annotation">@SimulatorApplication</span>
<span class="annotation">@EnableWebService</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Simulator</span> {
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        SpringApplication.run(Simulator.class, args);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <strong>@EnableWebService</strong> annotation performs some auto configuration steps and loads required beans for the Spring application context
in the Spring boot application.</p>
</div>
<div class="paragraph">
<p>After that we are ready to handle incoming SOAP Web Service calls on the simulator. We can use the default scenario base class for SOAP Web Services.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Scenario</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">Hello</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">HelloScenario</span> <span class="directive">extends</span> SimulatorWebServiceScenario {

    <span class="annotation">@Override</span>
    <span class="directive">protected</span> <span class="type">void</span> configure() {
        scenario()
            .receive()
            .payload(<span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;Hello xmlns=</span><span class="char">\&quot;</span><span class="content">http://citrusframework.org/schemas/hello</span><span class="char">\&quot;</span><span class="content">&gt;</span><span class="delimiter">&quot;</span></span> +
                        <span class="string"><span class="delimiter">&quot;</span><span class="content">Say Hello!</span><span class="delimiter">&quot;</span></span> +
                     <span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;/Hello&gt;</span><span class="delimiter">&quot;</span></span>)
            .header(SoapMessageHeaders.SOAP_ACTION, <span class="string"><span class="delimiter">&quot;</span><span class="content">Hello</span><span class="delimiter">&quot;</span></span>);

        scenario()
            .send()
            .payload(<span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;HelloResponse xmlns=</span><span class="char">\&quot;</span><span class="content">http://citrusframework.org/schemas/hello</span><span class="char">\&quot;</span><span class="content">&gt;</span><span class="delimiter">&quot;</span></span> +
                        <span class="string"><span class="delimiter">&quot;</span><span class="content">Hi there!</span><span class="delimiter">&quot;</span></span> +
                     <span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;/HelloResponse&gt;</span><span class="delimiter">&quot;</span></span>);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <strong>SimulatorWebServiceScenario</strong> automatically handles the SOAP envelope so we do not have to deal with that in the scenario receive and send operations. Also
the scenario receive operation has access to the SOAP action of the incoming request call. Besides that we can also <a href="#ws-soap-faults">return a SOAP fault</a> message as scenario outcome.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s move on with having a look at the SOAP related configuration options as described in the following sections.</p>
</div>
<div class="sect2">
<h3 id="ws-config"><a class="anchor" href="#ws-config"></a>5.1. Configuration</h3>
<div class="paragraph">
<p>Once the SOAP support is enabled on the simulator we have different configuration options. The most comfortable way is to
add a <strong>SimulatorWebServiceAdapter</strong> implementation to the classpath. The adapter provides several configuration methods.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">abstract</span> <span class="type">class</span> <span class="class">SimulatorWebServiceAdapter</span> <span class="directive">implements</span> SimulatorWebServiceConfigurer {
    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> servletMapping() {
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">/services/ws/*</span><span class="delimiter">&quot;</span></span>;
    }

    <span class="annotation">@Override</span>
    <span class="directive">public</span> MappingKeyExtractor mappingKeyExtractor() {
        <span class="keyword">return</span> <span class="keyword">new</span> XPathPayloadMappingKeyExtractor();
    }

    <span class="annotation">@Override</span>
    <span class="directive">public</span> EndpointInterceptor<span class="type">[]</span> interceptors() {
        <span class="keyword">return</span> <span class="keyword">new</span> EndpointInterceptor<span class="type">[]</span> { <span class="keyword">new</span> LoggingEndpointInterceptor() };
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The adapter defines methods that configure the simulator SOAP message handling. For instance we can add another mapping key extractor implementation or
add endpoint interceptors to the SOAP service call handling.</p>
</div>
<div class="paragraph">
<p>The <strong>servletMapping</strong> defines how clients can access the simulator SOAP service. Assuming the Spring boot simulator application is running on port 8080 the
SOAP service would be accessible on this URI:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>http://localhhost:8080/services/ws/*</code></pre>
</div>
</div>
<div class="paragraph">
<p>The clients can send SOAP calls to that endpoint URI then. The simulator will respond with respective SOAP responses based on the called
scenario.</p>
</div>
<div class="paragraph">
<p>You can simply extend the adapter in a custom class for adding customizations.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Component</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MySimulatorWebServiceAdapter</span> <span class="directive">extends</span> SimulatorWebServiceAdapter {

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> servletMapping() {
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">/my-soap-service/**</span><span class="delimiter">&quot;</span></span>;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see the class is annotated with <strong>@Component</strong> annotation. This is because the adapter should be recognized by Spring in order to overwrite the default
SOAP adapter behavior. The custom adapter just overwrites the <strong>servletMapping</strong> method so the SOAP simulator API will be accessible for clients under this endpoint URI:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>http://localhhost:8080/my-soap-service/*</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is the simplest way to customize the simulator SOAP support. We can also use the adapter extension directly on the Spring boot main application class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">com.consol.citrus.simulator.annotation.EnableWebService</span>;
<span class="keyword">import</span> <span class="include">com.consol.citrus.simulator.annotation.SimulatorWebServiceAdapter</span>;
<span class="keyword">import</span> <span class="include">com.consol.citrus.simulator.annotation.SimulatorApplication</span>;
<span class="keyword">import</span> <span class="include">org.springframework.boot.SpringApplication</span>;
<span class="keyword">import</span> <span class="include">org.springframework.boot.autoconfigure.SpringBootApplication</span>;

<span class="annotation">@SpringBootApplication</span>
<span class="annotation">@SimulatorApplication</span>
<span class="annotation">@EnableWebService</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Simulator</span> <span class="directive">extends</span> SimulatorWebServiceAdapter {

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> servletMapping() {
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">/my-soap-service/**</span><span class="delimiter">&quot;</span></span>;
    }

    <span class="annotation">@Override</span>
    <span class="directive">public</span> MappingKeyExtractor mappingKeyExtractor() {
        <span class="keyword">return</span> <span class="keyword">new</span> SoapActionMappingKeyExtractor();
    }

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        SpringApplication.run(Simulator.class, args);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>So we have <strong>@EnableWebService</strong> and SOAP adapter customizations combined on one single class.</p>
</div>
</div>
<div class="sect2">
<h3 id="advanced-customizations-2"><a class="anchor" href="#advanced-customizations-2"></a>5.2. Advanced customizations</h3>
<div class="paragraph">
<p>For a more advanced configuration option we can extend the <strong>SimulatorWebServiceSupport</strong> implementation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">com.consol.citrus.simulator.annotation.EnableWebService</span>;
<span class="keyword">import</span> <span class="include">com.consol.citrus.simulator.annotation.SimulatorWebServiceSupport</span>;
<span class="keyword">import</span> <span class="include">com.consol.citrus.simulator.annotation.SimulatorApplication</span>;
<span class="keyword">import</span> <span class="include">org.springframework.boot.SpringApplication</span>;
<span class="keyword">import</span> <span class="include">org.springframework.boot.autoconfigure.SpringBootApplication</span>;

<span class="annotation">@SpringBootApplication</span>
<span class="annotation">@SimulatorApplication</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Simulator</span> <span class="directive">extends</span> SimulatorWebServiceSupport {

    <span class="annotation">@Override</span>
    <span class="directive">protected</span> <span class="predefined-type">String</span> getServletMapping() {
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">/my-soap-service/**</span><span class="delimiter">&quot;</span></span>;
    }

    <span class="annotation">@Bean</span>
    <span class="directive">public</span> ServletRegistrationBean messageDispatcherServlet(ApplicationContext applicationContext) {
        MessageDispatcherServlet servlet = <span class="keyword">new</span> MessageDispatcherServlet();
        servlet.setApplicationContext(applicationContext);
        servlet.setTransformWsdlLocations(<span class="predefined-constant">true</span>);
        <span class="keyword">return</span> <span class="keyword">new</span> ServletRegistrationBean(servlet, getDispatcherServletMapping());
    }

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        SpringApplication.run(Simulator.class, args);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>With that configuration option we can overwrite SOAP support auto configuration features on the simulator such as the <strong>messageDispatcherServlet</strong>.
We can not use the <strong>@EnableWebService</strong> auto configuration annotation then. Instead we extend the <strong>SimulatorWebServiceSupport</strong> implementation directly.</p>
</div>
</div>
<div class="sect2">
<h3 id="ws-soap-faults"><a class="anchor" href="#ws-soap-faults"></a>5.3. SOAP faults</h3>
<div class="paragraph">
<p>The simulator is in charge of sending proper response messages to the calling client. When using SOAP we might also want to send
back a SOAP fault message. Therefore the default Web Service scenario implementation also provides fault responses as scenario result.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Scenario</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">GoodNight</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">GoodNightScenario</span> <span class="directive">extends</span> SimulatorWebServiceScenario {

    <span class="annotation">@Override</span>
    <span class="directive">protected</span> <span class="type">void</span> configure() {
        scenario()
            .receive()
            .payload(<span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;GoodNight xmlns=</span><span class="char">\&quot;</span><span class="content">http://citrusframework.org/schemas/hello</span><span class="char">\&quot;</span><span class="content">&gt;</span><span class="delimiter">&quot;</span></span> +
                        <span class="string"><span class="delimiter">&quot;</span><span class="content">Go to sleep!</span><span class="delimiter">&quot;</span></span> +
                     <span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;/GoodNight&gt;</span><span class="delimiter">&quot;</span></span>)
            .header(SoapMessageHeaders.SOAP_ACTION, <span class="string"><span class="delimiter">&quot;</span><span class="content">GoodNight</span><span class="delimiter">&quot;</span></span>);

        scenario()
            .sendFault()
            .faultCode(<span class="string"><span class="delimiter">&quot;</span><span class="content">{http://citrusframework.org}CITRUS:SIM-1001</span><span class="delimiter">&quot;</span></span>)
            .faultString(<span class="string"><span class="delimiter">&quot;</span><span class="content">No sleep for me!</span><span class="delimiter">&quot;</span></span>);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The example above shows a simple fault generating SOAP scenario. The base class <strong>SimulatorWebServiceScenario</strong> provides
the <strong>sendFault()</strong> method in order to create proper SOAP fault messages. The simulator automatically add SOAP envelope and SOAP fault
message details for you. So we can decide wheather to provide a success response or SOAP fault.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="jms-support"><a class="anchor" href="#jms-support"></a>6. JMS support</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The simulator is able to receive messages from any JMS message broker. The simulator will constantly poll a JMS destination (queue or topic)
for incoming request messages. When the queue is of synchronous nature the simulator is able to send synchronous response messages. The simulator defines a special
JMS enabling annotation that we can use on the application class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">com.consol.citrus.simulator.annotation.EnableJms</span>;
<span class="keyword">import</span> <span class="include">com.consol.citrus.simulator.annotation.SimulatorApplication</span>;
<span class="keyword">import</span> <span class="include">org.springframework.boot.SpringApplication</span>;
<span class="keyword">import</span> <span class="include">org.springframework.boot.autoconfigure.SpringBootApplication</span>;

<span class="annotation">@SpringBootApplication</span>
<span class="annotation">@SimulatorApplication</span>
<span class="annotation">@EnableJms</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Simulator</span> {
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        SpringApplication.run(Simulator.class, args);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <strong>@EnableJms</strong> annotation performs some auto configuration steps and loads required beans for the Spring application context
in the Spring boot application.</p>
</div>
<div class="paragraph">
<p>With that piece of configuration we are ready to handle incoming JMS messages on the simulator. Of course we need a JMS connection factory and other JMS related
configuration options as described in the following sections.</p>
</div>
<div class="sect2">
<h3 id="jms-config"><a class="anchor" href="#jms-config"></a>6.1. Configuration</h3>
<div class="paragraph">
<p>Once the JMS support is enabled on the simulator we have different configuration options. The most comfortable way is to
add a <strong>SimulatorJmsAdapter</strong> implementation to the classpath. The adapter provides several configuration methods.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">abstract</span> <span class="type">class</span> <span class="class">SimulatorJmsAdapter</span> <span class="directive">implements</span> SimulatorJmsConfigurer {
    <span class="annotation">@Override</span>
    <span class="directive">public</span> ConnectionFactory connectionFactory() {
        <span class="keyword">return</span> <span class="keyword">new</span> SingleConnectionFactory();
    }

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> destinationName() {
        <span class="keyword">return</span> <span class="predefined-type">System</span>.getProperty(<span class="string"><span class="delimiter">&quot;</span><span class="content">citrus.simulator.jms.destination</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Citrus.Simulator.Inbound</span><span class="delimiter">&quot;</span></span>);
    }

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">boolean</span> useSoapEnvelope() {
        <span class="keyword">return</span> <span class="predefined-constant">false</span>;
    }

    <span class="annotation">@Override</span>
    <span class="directive">public</span> MappingKeyExtractor mappingKeyExtractor() {
        <span class="keyword">return</span> <span class="keyword">new</span> XPathPayloadMappingKeyExtractor();
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The adapter defines methods that configure the simulator JMS handling. For instance we can add another mapping key extractor implementation or
enable automatic SOAP envelope handling.</p>
</div>
<div class="paragraph">
<p>The <strong>destinationName</strong> defines the incoming JMS destination to poll. The <strong>connectionFactory</strong> is mandatory in order to connect to a JMS
message broker.</p>
</div>
<div class="paragraph">
<p>You can simply extend the adapter in a custom class for adding customizations.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Component</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">MySimulatorJmsAdapter</span> <span class="directive">extends</span> SimulatorJmsAdapter {

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> destinationName() {
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">JMS.Queue.simulator.inbound</span><span class="delimiter">&quot;</span></span>;
    }

    <span class="annotation">@Override</span>
    <span class="directive">public</span> ConnectionFactory connectionFactory() {
        <span class="keyword">return</span> <span class="keyword">new</span> ActiveMQConnectionFactory(<span class="string"><span class="delimiter">&quot;</span><span class="content">tcp://localhost:61616</span><span class="delimiter">&quot;</span></span>);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see the class is annotated with <strong>@Component</strong> annotation. This is because the adapter should be recognized by Spring in order to overwrite the default
JMS adapter behavior. The custom adapter just overwrites the <strong>connectionFactory</strong> and <strong>destinationName</strong> methods so the JMS simulator will connect to the ActiveMQ message broker
and listen for incoming requests on that queue.</p>
</div>
<div class="paragraph">
<p>This is the simplest way to customize the simulator JMS support. We can also use the adapter extension directly on the Spring boot main application class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">com.consol.citrus.simulator.annotation.EnableJms</span>;
<span class="keyword">import</span> <span class="include">com.consol.citrus.simulator.annotation.SimulatorJmsAdapter</span>;
<span class="keyword">import</span> <span class="include">com.consol.citrus.simulator.annotation.SimulatorApplication</span>;
<span class="keyword">import</span> <span class="include">org.springframework.boot.SpringApplication</span>;
<span class="keyword">import</span> <span class="include">org.springframework.boot.autoconfigure.SpringBootApplication</span>;

<span class="annotation">@SpringBootApplication</span>
<span class="annotation">@SimulatorApplication</span>
<span class="annotation">@EnableJms</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Simulator</span> <span class="directive">extends</span> SimulatorJmsAdapter {

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> destinationName() {
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">JMS.Queue.simulator.inbound</span><span class="delimiter">&quot;</span></span>;
    }

    <span class="annotation">@Override</span>
    <span class="directive">public</span> ConnectionFactory connectionFactory() {
        <span class="keyword">return</span> <span class="keyword">new</span> ActiveMQConnectionFactory(<span class="string"><span class="delimiter">&quot;</span><span class="content">tcp://localhost:61616</span><span class="delimiter">&quot;</span></span>);
    }

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        SpringApplication.run(Simulator.class, args);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>So we have <strong>@EnableJms</strong> and JMS adapter customizations combined on one single class.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="endpoint-support"><a class="anchor" href="#endpoint-support"></a>7. Endpoint support</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We have seen how the simulator handles different transports such as <a href="#rest-support">Http REST</a>, <a href="#ws-support">SOAP web services</a> and <a href="#jms-support">JMS</a>.
Now the simulator is also able to handle other message transports such as mail communication, JMX mbean server, RMI invocations and much more. The
simulator is able to deal with any kind of endpoint component that is supported in Citrus framework.</p>
</div>
<div class="paragraph">
<p>The generic endpoint support is added with <strong>@EnableEndpointComponent</strong> annotation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">com.consol.citrus.simulator.annotation.EnableEndpointComponent</span>;
<span class="keyword">import</span> <span class="include">com.consol.citrus.simulator.annotation.SimulatorApplication</span>;
<span class="keyword">import</span> <span class="include">org.springframework.boot.SpringApplication</span>;
<span class="keyword">import</span> <span class="include">org.springframework.boot.autoconfigure.SpringBootApplication</span>;

<span class="annotation">@SpringBootApplication</span>
<span class="annotation">@SimulatorApplication</span>
<span class="annotation">@EnableEndpointComponent</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Simulator</span> {
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        SpringApplication.run(Simulator.class, args);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <strong>@EnableEndpointComponent</strong> annotation performs some auto configuration steps and loads required beans for the Spring application context
in the Spring boot application. Once we use that feature we can have any Citrus endpoint component as inbound source for simulator scenarios. This means
we can have a mail server or a RMI server that is simulated with proper response messages.</p>
</div>
<div class="paragraph">
<p>As we are using generic endpoint components as inbound source we need to set the endpoint in the configuration. Read about that in the following sections.</p>
</div>
<div class="sect2">
<h3 id="endpoint-config"><a class="anchor" href="#endpoint-config"></a>7.1. Configuration</h3>
<div class="paragraph">
<p>When using generic Citrus endpoints as simulator inbound source we need to configure those endpoint components. The most comfortable way is to
add a <strong>SimulatorEndpointComponentAdapter</strong> implementation to the classpath. The adapter provides several configuration methods.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">abstract</span> <span class="type">class</span> <span class="class">SimulatorEndpointComponentAdapter</span> <span class="directive">implements</span> SimulatorEndpointComponentConfigurer {

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="directive">abstract</span> Endpoint endpoint(ApplicationContext applicationContext);

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">boolean</span> useSoapEnvelope() {
        <span class="keyword">return</span> <span class="predefined-constant">false</span>;
    }

    <span class="annotation">@Override</span>
    <span class="directive">public</span> MappingKeyExtractor mappingKeyExtractor() {
        <span class="keyword">return</span> <span class="keyword">new</span> XPathPayloadMappingKeyExtractor();
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The adapter defines methods that configure the endpoint component used as inbound source. As usual we can set the mapping key extractor implementation or
add automatic SOAP envelope support.</p>
</div>
<div class="paragraph">
<p>More importantly we need to define an inbound endpoint that is used as source for scenarios. Let&#8217;s have a simple endpoint component adapter example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">com.consol.citrus.simulator.annotation.EnableEndpointComponent</span>;
<span class="keyword">import</span> <span class="include">com.consol.citrus.simulator.annotation.SimulatorEndpointComponentAdapter</span>;
<span class="keyword">import</span> <span class="include">com.consol.citrus.simulator.annotation.SimulatorApplication</span>;
<span class="keyword">import</span> <span class="include">org.springframework.boot.SpringApplication</span>;
<span class="keyword">import</span> <span class="include">org.springframework.boot.autoconfigure.SpringBootApplication</span>;

<span class="annotation">@SpringBootApplication</span>
<span class="annotation">@SimulatorApplication</span>
<span class="annotation">@EnableEndpointComponent</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">Simulator</span> <span class="directive">extends</span> SimulatorEndpointComponentAdapter {

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        SpringApplication.run(Simulator.class, args);
    }

    <span class="annotation">@Override</span>
    <span class="directive">public</span> Endpoint endpoint(ApplicationContext applicationContext) {
        MailServer mailServer = <span class="keyword">new</span> MailServer();
        mailServer.setPort(<span class="integer">2222</span>);
        mailServer.setAutoStart(<span class="predefined-constant">true</span>);

        <span class="keyword">return</span> mailServer;
    }

    <span class="annotation">@Override</span>
    <span class="directive">public</span> MappingKeyExtractor mappingKeyExtractor() {
        XPathPayloadMappingKeyExtractor mappingKeyExtractor = <span class="keyword">new</span> XPathPayloadMappingKeyExtractor();
        NamespaceContextBuilder namespaceContextBuilder = <span class="keyword">new</span> NamespaceContextBuilder();
        namespaceContextBuilder.getNamespaceMappings().put(<span class="string"><span class="delimiter">&quot;</span><span class="content">mail</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.citrusframework.org/schema/mail/message</span><span class="delimiter">&quot;</span></span>);
        mappingKeyExtractor.setNamespaceContextBuilder(namespaceContextBuilder);
        mappingKeyExtractor.setXpathExpression(<span class="string"><span class="delimiter">&quot;</span><span class="content">/mail:mail-message/mail:subject</span><span class="delimiter">&quot;</span></span>);
        <span class="keyword">return</span> mappingKeyExtractor;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The custom adapter defines a Citrus mail server endpoint that should be used as inbound source. Any mail message that arrives at this mail server component will
trigger a new simulator scenario then. Also we overwrite the mapping key extractor implementation so that the mail subject evaluates to the scenario that should be executed.</p>
</div>
<div class="paragraph">
<p>This configuration would lead us to a mail server that responds to incoming mail messages base on the mail subject. So we can have several simulator
scenarios for different mail messages.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Scenario</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">Hello</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">HelloScenario</span> <span class="directive">extends</span> SimulatorEndpointScenario {

    <span class="annotation">@Override</span>
    <span class="directive">protected</span> <span class="type">void</span> configure() {
        scenario()
            .receive()
            .payload(<span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;mail-message xmlns=</span><span class="char">\&quot;</span><span class="content">http://www.citrusframework.org/schema/mail/message</span><span class="char">\&quot;</span><span class="content">&gt;</span><span class="delimiter">&quot;</span></span> +
                        <span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;from&gt;user@citrusframework.org&lt;/from&gt;</span><span class="delimiter">&quot;</span></span> +
                        <span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;to&gt;citrus@citrusframework.org&lt;/to&gt;</span><span class="delimiter">&quot;</span></span> +
                        <span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;cc&gt;&lt;/cc&gt;</span><span class="delimiter">&quot;</span></span> +
                        <span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;bcc&gt;&lt;/bcc&gt;</span><span class="delimiter">&quot;</span></span> +
                        <span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;subject&gt;Hello&lt;/subject&gt;</span><span class="delimiter">&quot;</span></span> +
                        <span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;body&gt;</span><span class="delimiter">&quot;</span></span> +
                            <span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;contentType&gt;text/plain; charset=utf-8&lt;/contentType&gt;</span><span class="delimiter">&quot;</span></span> +
                            <span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;content&gt;Say Hello!&lt;/content&gt;</span><span class="delimiter">&quot;</span></span> +
                        <span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;/body&gt;</span><span class="delimiter">&quot;</span></span> +
                    <span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;/mail-message&gt;</span><span class="delimiter">&quot;</span></span>);

        scenario()
            .send()
            .payload(<span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;mail-response xmlns=</span><span class="char">\&quot;</span><span class="content">http://www.citrusframework.org/schema/mail/message</span><span class="char">\&quot;</span><span class="content">&gt;</span><span class="delimiter">&quot;</span></span> +
                        <span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;code&gt;250&lt;/code&gt;</span><span class="delimiter">&quot;</span></span> +
                        <span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;message&gt;OK&lt;/message&gt;</span><span class="delimiter">&quot;</span></span> +
                    <span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;/mail-response&gt;</span><span class="delimiter">&quot;</span></span>);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The scenario implementation above uses the base class <strong>SimulatorEndpointScenario</strong> and listens for mail messages of subject <strong>Hello</strong>. The
mail XML marshalling is automatically done by Citrus. This is the usual way how the Citrus mail component handles mail messages and responses. That means we can use the default Citrus
features in our simulator, too. The scenario sends back a positive mail response to the calling client.</p>
</div>
<div class="paragraph">
<p>This is how we can use any Citrus endpoint component as simulator inbound source. This gives us the opportunity to support a huge set of message transports and
message types in our simulator applications. Each incoming request on the endpoint component triggers a new simulator scenario.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="user-interface"><a class="anchor" href="#user-interface"></a>8. User interface</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The simulator application is started as a Spring boot web application. Users can access an administrative user interface
for reviewing the simulator status and executed scenarios and their outcome.</p>
</div>
<div class="paragraph">
<p>Open your browser and point to the simulator UI:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>http://localhost:8080</code></pre>
</div>
</div>
<div class="paragraph">
<p>You will see a simple web application that gives you information about the simulator.</p>
</div>
<div class="sect2">
<h3 id="user-interface-status"><a class="anchor" href="#user-interface-status"></a>8.1. Status</h3>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
<div class="sect2">
<h3 id="user-interface-run"><a class="anchor" href="#user-interface-run"></a>8.2. Run scenarios</h3>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="links"><a class="anchor" href="#links"></a>9. Links &amp; Further reading</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>The <a href="https://www.citrusframework.org/reference/html/">Citrus reference manual</a>
gives you a detailed description of all Citrus features.</p>
</li>
<li>
<p><a href="https://github.com/christophd/citrus-simulator/blob/master/simulator-samples">Sample projects</a>
demonstrate typical simulator scenarios with different message transports</p>
</li>
<li>
<p><a href="https://www.citrusframework.org/docs/history">ChangeLog</a> shows the release history.</p>
</li>
<li>
<p><a href="https://github.com/christophd/citrus-simulator/blob/master/simulator-docs/contributing.md">Contributing</a>
explains how you can contribute to this project. Pull requests are highly appreciated!</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 0.10.0-SNAPSHOT<br>
Last updated 2017-07-06 14:14:24 MESZ
</div>
</div>
<style>

    #footer-sponsor {
        position: absolute;
        bottom: 5px;
        right: 25px;
        float: right;
    }

</style>
<div id="footer-sponsor">
    <a href="https://www.consol.de" target="_blank" alt="ConSol Software GmbH"><img src="images/sponsor-logo.png" /></a>
</div>
</body>
</html>